<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Monitor & Analysis</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; padding: 0; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script>
        const { useState, useEffect, createElement: h } = React;
        const e = React.createElement;

        const CRYPTOCURRENCIES = [
          { id: 'bitcoin', symbol: 'BTC', name: 'Bitcoin' },
          { id: 'ethereum', symbol: 'ETH', name: 'Ethereum' },
          { id: 'binancecoin', symbol: 'BNB', name: 'BNB' },
          { id: 'solana', symbol: 'SOL', name: 'Solana' },
          { id: 'ripple', symbol: 'XRP', name: 'Ripple' },
          { id: 'cardano', symbol: 'ADA', name: 'Cardano' }
        ];

        function CryptoMonitor() {
          const [cryptoData, setCryptoData] = useState([]);
          const [historicalData, setHistoricalData] = useState({});
          const [selectedCrypto, setSelectedCrypto] = useState('bitcoin');
          const [loading, setLoading] = useState(true);
          const [error, setError] = useState(null);
          const [lastUpdate, setLastUpdate] = useState(null);

          const fetchCryptoData = async () => {
            try {
              const ids = CRYPTOCURRENCIES.map(c => c.id).join(',');
              const response = await fetch(
                `https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=${ids}&order=market_cap_desc&sparkline=false&price_change_percentage=1h,24h,7d`
              );
              
              if (!response.ok) {
                throw new Error('Failed to fetch data');
              }
              
              const data = await response.json();
              setCryptoData(data);
              setLastUpdate(new Date());
              setLoading(false);
              setError(null);
            } catch (err) {
              console.error('Error fetching crypto data:', err);
              setError(err.message);
              setLoading(false);
            }
          };

          const fetchHistoricalData = async (cryptoId) => {
            try {
              const response = await fetch(
                `https://api.coingecko.com/api/v3/coins/${cryptoId}/market_chart?vs_currency=usd&days=7&interval=daily`
              );
              
              if (!response.ok) return;
              
              const data = await response.json();
              
              const formatted = data.prices.map(([timestamp, price]) => ({
                date: new Date(timestamp).toLocaleDateString(),
                price: price.toFixed(2)
              }));
              
              setHistoricalData(prev => ({ ...prev, [cryptoId]: formatted }));
            } catch (err) {
              console.error('Error fetching historical data:', err);
            }
          };

          useEffect(() => {
            fetchCryptoData();
            const interval = setInterval(fetchCryptoData, 60000);
            return () => clearInterval(interval);
          }, []);

          useEffect(() => {
            if (selectedCrypto) {
              fetchHistoricalData(selectedCrypto);
            }
          }, [selectedCrypto]);

          const getSignal = (crypto) => {
            const priceChange24h = crypto.price_change_percentage_24h || 0;
            const priceChange7d = crypto.price_change_percentage_7d_in_currency || 0;
            
            if (priceChange24h > 5 && priceChange7d > 10) {
              return { text: 'Strong Buy', color: 'text-green-600', bg: 'bg-green-100' };
            } else if (priceChange24h > 2 && priceChange7d > 5) {
              return { text: 'Buy', color: 'text-green-500', bg: 'bg-green-50' };
            } else if (priceChange24h < -5 && priceChange7d < -10) {
              return { text: 'Strong Sell', color: 'text-red-600', bg: 'bg-red-100' };
            } else if (priceChange24h < -2 && priceChange7d < -5) {
              return { text: 'Sell', color: 'text-red-500', bg: 'bg-red-50' };
            } else {
              return { text: 'Hold', color: 'text-gray-600', bg: 'bg-gray-100' };
            }
          };

          const selectedCryptoData = cryptoData.find(c => c.id === selectedCrypto);
          const chartData = historicalData[selectedCrypto] || [];

          if (loading) {
            return e('div', 
              { className: 'min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center' },
              e('div', { className: 'text-white text-2xl' }, 'Loading crypto data...')
            );
          }

          if (error) {
            return e('div', 
              { className: 'min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center' },
              e('div', { className: 'text-white text-xl' }, 
                e('p', null, 'Error loading data: ' + error),
                e('button', 
                  { 
                    className: 'mt-4 px-4 py-2 bg-purple-600 rounded hover:bg-purple-700',
                    onClick: () => { setLoading(true); fetchCryptoData(); }
                  }, 
                  'Retry'
                )
              )
            );
          }

          return e('div', 
            { className: 'min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-6' },
            e('div', { className: 'max-w-7xl mx-auto' },
              // Header
              e('div', { className: 'mb-8' },
                e('h1', { className: 'text-4xl font-bold text-white mb-2' }, 
                  'ðŸ“Š Crypto Monitor & Analysis'
                ),
                e('p', { className: 'text-purple-200' },
                  'Real-time cryptocurrency tracking and technical analysis'
                ),
                lastUpdate && e('p', { className: 'text-purple-300 text-sm mt-2' },
                  'Last updated: ' + lastUpdate.toLocaleTimeString()
                )
              ),
              
              // Crypto Cards Grid
              e('div', { className: 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8' },
                cryptoData.map(crypto => {
                  const signal = getSignal(crypto);
                  const isPositive = crypto.price_change_percentage_24h >= 0;
                  
                  return e('div', {
                    key: crypto.id,
                    onClick: () => setSelectedCrypto(crypto.id),
                    className: `bg-white/10 backdrop-blur-lg rounded-lg p-6 cursor-pointer transition-all hover:bg-white/20 ${
                      selectedCrypto === crypto.id ? 'ring-2 ring-purple-400' : ''
                    }`
                  },
                    e('div', { className: 'flex items-start justify-between mb-4' },
                      e('div', { className: 'flex items-center gap-3' },
                        e('img', { src: crypto.image, alt: crypto.name, className: 'w-10 h-10' }),
                        e('div', null,
                          e('h3', { className: 'text-white font-bold text-lg' }, crypto.symbol.toUpperCase()),
                          e('p', { className: 'text-purple-200 text-sm' }, crypto.name)
                        )
                      ),
                      e('span', { className: `px-3 py-1 rounded-full text-xs font-semibold ${signal.bg} ${signal.color}` },
                        signal.text
                      )
                    ),
                    
                    e('div', { className: 'space-y-2' },
                      e('div', { className: 'flex items-center justify-between' },
                        e('span', { className: 'text-purple-200 text-sm' }, 'Price'),
                        e('span', { className: 'text-white font-bold text-xl' },
                          '$' + crypto.current_price.toLocaleString()
                        )
                      ),
                      
                      e('div', { className: 'flex items-center justify-between' },
                        e('span', { className: 'text-purple-200 text-sm' }, '24h Change'),
                        e('span', { className: `flex items-center gap-1 font-semibold ${isPositive ? 'text-green-400' : 'text-red-400'}` },
                          isPositive ? 'ðŸ“ˆ' : 'ðŸ“‰',
                          ' ' + Math.abs(crypto.price_change_percentage_24h).toFixed(2) + '%'
                        )
                      ),
                      
                      e('div', { className: 'flex items-center justify-between' },
                        e('span', { className: 'text-purple-200 text-sm' }, 'Market Cap'),
                        e('span', { className: 'text-white font-semibold' },
                          '$' + (crypto.market_cap / 1e9).toFixed(2) + 'B'
                        )
                      ),
                      
                      e('div', { className: 'flex items-center justify-between' },
                        e('span', { className: 'text-purple-200 text-sm' }, 'Volume 24h'),
                        e('span', { className: 'text-white font-semibold' },
                          '$' + (crypto.total_volume / 1e9).toFixed(2) + 'B'
                        )
                      )
                    )
                  );
                })
              ),
              
              // Detailed Analysis Section
              selectedCryptoData && e('div', { className: 'bg-white/10 backdrop-blur-lg rounded-lg p-6' },
                e('div', { className: 'flex items-center gap-3 mb-6' },
                  e('h2', { className: 'text-2xl font-bold text-white' },
                    'ðŸ“ˆ Detailed Analysis: ' + selectedCryptoData.name
                  )
                ),
                
                e('div', { className: 'grid grid-cols-2 md:grid-cols-4 gap-4 mb-6' },
                  e('div', { className: 'bg-white/5 rounded-lg p-4' },
                    e('p', { className: 'text-purple-200 text-sm mb-1' }, '24h High'),
                    e('p', { className: 'text-white font-bold text-lg' },
                      '$' + selectedCryptoData.high_24h.toLocaleString()
                    )
                  ),
                  e('div', { className: 'bg-white/5 rounded-lg p-4' },
                    e('p', { className: 'text-purple-200 text-sm mb-1' }, '24h Low'),
                    e('p', { className: 'text-white font-bold text-lg' },
                      '$' + selectedCryptoData.low_24h.toLocaleString()
                    )
                  ),
                  e('div', { className: 'bg-white/5 rounded-lg p-4' },
                    e('p', { className: 'text-purple-200 text-sm mb-1' }, '7d Change'),
                    e('p', { 
                      className: `font-bold text-lg ${
                        selectedCryptoData.price_change_percentage_7d_in_currency >= 0 ? 'text-green-400' : 'text-red-400'
                      }` 
                    },
                      selectedCryptoData.price_change_percentage_7d_in_currency?.toFixed(2) + '%'
                    )
                  ),
                  e('div', { className: 'bg-white/5 rounded-lg p-4' },
                    e('p', { className: 'text-purple-200 text-sm mb-1' }, 'Market Rank'),
                    e('p', { className: 'text-white font-bold text-lg' },
                      '#' + selectedCryptoData.market_cap_rank
                    )
                  )
                ),
                
                // Price History List
                chartData.length > 0 && e('div', { className: 'bg-white/5 rounded-lg p-4' },
                  e('h3', { className: 'text-white font-semibold mb-4' }, '7-Day Price History'),
                  e('div', { className: 'space-y-2' },
                    chartData.map((item, idx) =>
                      e('div', { 
                        key: idx, 
                        className: 'flex justify-between items-center p-2 bg-white/5 rounded'
                      },
                        e('span', { className: 'text-purple-200 text-sm' }, item.date),
                        e('span', { className: 'text-white font-semibold' }, '$' + parseFloat(item.price).toLocaleString())
                      )
                    )
                  )
                )
              )
            )
          );
        }

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(CryptoMonitor));
    </script>
</body>
</html>
