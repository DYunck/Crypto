<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Monitor & Analysis</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/recharts@2.5.0/dist/Recharts.js"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        const { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } = Recharts;

        const CRYPTOCURRENCIES = [
          { id: 'bitcoin', symbol: 'BTC', name: 'Bitcoin' },
          { id: 'ethereum', symbol: 'ETH', name: 'Ethereum' },
          { id: 'binancecoin', symbol: 'BNB', name: 'BNB' },
          { id: 'solana', symbol: 'SOL', name: 'Solana' },
          { id: 'ripple', symbol: 'XRP', name: 'Ripple' },
          { id: 'cardano', symbol: 'ADA', name: 'Cardano' }
        ];

        // Lucide React icons as SVG components
        const TrendingUp = () => (
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
            <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
            <polyline points="17 6 23 6 23 12"></polyline>
          </svg>
        );

        const TrendingDown = () => (
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
            <polyline points="23 18 13.5 8.5 8.5 13.5 1 6"></polyline>
            <polyline points="17 18 23 18 23 12"></polyline>
          </svg>
        );

        const Activity = ({ className }) => (
          <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
          </svg>
        );

        const BarChart3 = ({ className }) => (
          <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
            <path d="M3 3v18h18"></path>
            <path d="M18 17V9"></path>
            <path d="M13 17V5"></path>
            <path d="M8 17v-3"></path>
          </svg>
        );

        function CryptoMonitor() {
          const [cryptoData, setCryptoData] = useState([]);
          const [historicalData, setHistoricalData] = useState({});
          const [selectedCrypto, setSelectedCrypto] = useState('bitcoin');
          const [loading, setLoading] = useState(true);
          const [lastUpdate, setLastUpdate] = useState(null);

          const fetchCryptoData = async () => {
            try {
              const ids = CRYPTOCURRENCIES.map(c => c.id).join(',');
              const response = await fetch(
                `https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=${ids}&order=market_cap_desc&sparkline=false&price_change_percentage=1h,24h,7d`
              );
              const data = await response.json();
              setCryptoData(data);
              setLastUpdate(new Date());
              setLoading(false);
            } catch (error) {
              console.error('Error fetching crypto data:', error);
              setLoading(false);
            }
          };

          const fetchHistoricalData = async (cryptoId) => {
            try {
              const response = await fetch(
                `https://api.coingecko.com/api/v3/coins/${cryptoId}/market_chart?vs_currency=usd&days=30&interval=daily`
              );
              const data = await response.json();
              
              const formatted = data.prices.map(([timestamp, price]) => ({
                date: new Date(timestamp).toLocaleDateString(),
                price: price.toFixed(2)
              }));
              
              setHistoricalData(prev => ({ ...prev, [cryptoId]: formatted }));
            } catch (error) {
              console.error('Error fetching historical data:', error);
            }
          };

          useEffect(() => {
            fetchCryptoData();
            const interval = setInterval(fetchCryptoData, 60000);
            return () => clearInterval(interval);
          }, []);

          useEffect(() => {
            if (selectedCrypto) {
              fetchHistoricalData(selectedCrypto);
            }
          }, [selectedCrypto]);

          const calculateRSI = (prices) => {
            if (!prices || prices.length < 14) return null;
            
            let gains = 0;
            let losses = 0;
            
            for (let i = 1; i < 14; i++) {
              const change = prices[i] - prices[i - 1];
              if (change > 0) gains += change;
              else losses -= change;
            }
            
            const avgGain = gains / 14;
            const avgLoss = losses / 14;
            const rs = avgGain / avgLoss;
            const rsi = 100 - (100 / (1 + rs));
            
            return rsi.toFixed(2);
          };

          const getSignal = (crypto) => {
            const priceChange24h = crypto.price_change_percentage_24h || 0;
            const priceChange7d = crypto.price_change_percentage_7d_in_currency || 0;
            
            if (priceChange24h > 5 && priceChange7d > 10) {
              return { text: 'Strong Buy', color: 'text-green-600', bg: 'bg-green-100' };
            } else if (priceChange24h > 2 && priceChange7d > 5) {
              return { text: 'Buy', color: 'text-green-500', bg: 'bg-green-50' };
            } else if (priceChange24h < -5 && priceChange7d < -10) {
              return { text: 'Strong Sell', color: 'text-red-600', bg: 'bg-red-100' };
            } else if (priceChange24h < -2 && priceChange7d < -5) {
              return { text: 'Sell', color: 'text-red-500', bg: 'bg-red-50' };
            } else {
              return { text: 'Hold', color: 'text-gray-600', bg: 'bg-gray-100' };
            }
          };

          const selectedCryptoData = cryptoData.find(c => c.id === selectedCrypto);
          const chartData = historicalData[selectedCrypto] || [];

          if (loading) {
            return (
              <div className="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center">
                <div className="text-white text-2xl">Loading crypto data...</div>
              </div>
            );
          }

          return (
            <div className="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-6">
              <div className="max-w-7xl mx-auto">
                <div className="mb-8">
                  <h1 className="text-4xl font-bold text-white mb-2 flex items-center gap-3">
                    <Activity className="w-10 h-10" />
                    Crypto Monitor & Analysis
                  </h1>
                  <p className="text-purple-200">
                    Real-time cryptocurrency tracking and technical analysis
                  </p>
                  {lastUpdate && (
                    <p className="text-purple-300 text-sm mt-2">
                      Last updated: {lastUpdate.toLocaleTimeString()}
                    </p>
                  )}
                </div>

                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8">
                  {cryptoData.map(crypto => {
                    const signal = getSignal(crypto);
                    const isPositive = crypto.price_change_percentage_24h >= 0;
                    
                    return (
                      <div
                        key={crypto.id}
                        onClick={() => setSelectedCrypto(crypto.id)}
                        className={`bg-white/10 backdrop-blur-lg rounded-lg p-6 cursor-pointer transition-all hover:bg-white/20 ${
                          selectedCrypto === crypto.id ? 'ring-2 ring-purple-400' : ''
                        }`}
                      >
                        <div className="flex items-start justify-between mb-4">
                          <div className="flex items-center gap-3">
                            <img src={crypto.image} alt={crypto.name} className="w-10 h-10" />
                            <div>
                              <h3 className="text-white font-bold text-lg">{crypto.symbol.toUpperCase()}</h3>
                              <p className="text-purple-200 text-sm">{crypto.name}</p>
                            </div>
                          </div>
                          <span className={`px-3 py-1 rounded-full text-xs font-semibold ${signal.bg} ${signal.color}`}>
                            {signal.text}
                          </span>
                        </div>
                        
                        <div className="space-y-2">
                          <div className="flex items-center justify-between">
                            <span className="text-purple-200 text-sm">Price</span>
                            <span className="text-white font-bold text-xl">
                              ${crypto.current_price.toLocaleString()}
                            </span>
                          </div>
                          
                          <div className="flex items-center justify-between">
                            <span className="text-purple-200 text-sm">24h Change</span>
                            <span className={`flex items-center gap-1 font-semibold ${
                              isPositive ? 'text-green-400' : 'text-red-400'
                            }`}>
                              {isPositive ? <TrendingUp /> : <TrendingDown />}
                              {Math.abs(crypto.price_change_percentage_24h).toFixed(2)}%
                            </span>
                          </div>
                          
                          <div className="flex items-center justify-between">
                            <span className="text-purple-200 text-sm">Market Cap</span>
                            <span className="text-white font-semibold">
                              ${(crypto.market_cap / 1e9).toFixed(2)}B
                            </span>
                          </div>
                          
                          <div className="flex items-center justify-between">
                            <span className="text-purple-200 text-sm">Volume 24h</span>
                            <span className="text-white font-semibold">
                              ${(crypto.total_volume / 1e9).toFixed(2)}B
                            </span>
                          </div>
                        </div>
                      </div>
                    );
                  })}
                </div>

                {selectedCryptoData && (
                  <div className="bg-white/10 backdrop-blur-lg rounded-lg p-6">
                    <div className="flex items-center gap-3 mb-6">
                      <BarChart3 className="w-8 h-8 text-purple-400" />
                      <h2 className="text-2xl font-bold text-white">
                        Detailed Analysis: {selectedCryptoData.name}
                      </h2>
                    </div>

                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                      <div className="bg-white/5 rounded-lg p-4">
                        <p className="text-purple-200 text-sm mb-1">24h High</p>
                        <p className="text-white font-bold text-lg">
                          ${selectedCryptoData.high_24h.toLocaleString()}
                        </p>
                      </div>
                      <div className="bg-white/5 rounded-lg p-4">
                        <p className="text-purple-200 text-sm mb-1">24h Low</p>
                        <p className="text-white font-bold text-lg">
                          ${selectedCryptoData.low_24h.toLocaleString()}
                        </p>
                      </div>
                      <div className="bg-white/5 rounded-lg p-4">
                        <p className="text-purple-200 text-sm mb-1">7d Change</p>
                        <p className={`font-bold text-lg ${
                          selectedCryptoData.price_change_percentage_7d_in_currency >= 0 ? 'text-green-400' : 'text-red-400'
                        }`}>
                          {selectedCryptoData.price_change_percentage_7d_in_currency?.toFixed(2)}%
                        </p>
                      </div>
                      <div className="bg-white/5 rounded-lg p-4">
                        <p className="text-purple-200 text-sm mb-1">Market Rank</p>
                        <p className="text-white font-bold text-lg">
                          #{selectedCryptoData.market_cap_rank}
                        </p>
                      </div>
                    </div>

                    <div className="bg-white/5 rounded-lg p-4">
                      <h3 className="text-white font-semibold mb-4">30-Day Price Chart (USD)</h3>
                      <ResponsiveContainer width="100%" height={300}>
                        <LineChart data={chartData}>
                          <CartesianGrid strokeDasharray="3 3" stroke="#ffffff20" />
                          <XAxis 
                            dataKey="date" 
                            stroke="#ffffff60"
                            tick={{ fill: '#ffffff60' }}
                          />
                          <YAxis 
                            stroke="#ffffff60"
                            tick={{ fill: '#ffffff60' }}
                          />
                          <Tooltip 
                            contentStyle={{ 
                              backgroundColor: '#1e1b4b', 
                              border: '1px solid #7c3aed',
                              borderRadius: '8px'
                            }}
                            labelStyle={{ color: '#c4b5fd' }}
                          />
                          <Legend wrapperStyle={{ color: '#ffffff' }} />
                          <Line 
                            type="monotone" 
                            dataKey="price" 
                            stroke="#a78bfa" 
                            strokeWidth={2}
                            dot={false}
                            name="Price (USD)"
                          />
                        </LineChart>
                      </ResponsiveContainer>
                    </div>

                    <div className="mt-6 bg-white/5 rounded-lg p-4">
                      <h3 className="text-white font-semibold mb-4">Technical Analysis</h3>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                          <p className="text-purple-200 text-sm mb-2">RSI (14-day)</p>
                          <p className="text-white font-bold text-lg">
                            {chartData.length >= 14 
                              ? calculateRSI(chartData.slice(-14).map(d => parseFloat(d.price)))
                              : 'Calculating...'}
                          </p>
                          <p className="text-purple-300 text-xs mt-1">
                            {chartData.length >= 14 && calculateRSI(chartData.slice(-14).map(d => parseFloat(d.price))) < 30 
                              ? 'Oversold - Potential Buy Signal' 
                              : chartData.length >= 14 && calculateRSI(chartData.slice(-14).map(d => parseFloat(d.price))) > 70
                              ? 'Overbought - Potential Sell Signal'
                              : 'Neutral'}
                          </p>
                        </div>
                        <div>
                          <p className="text-purple-200 text-sm mb-2">Volatility (30-day)</p>
                          <p className="text-white font-bold text-lg">
                            {chartData.length > 0 
                              ? ((Math.max(...chartData.map(d => parseFloat(d.price))) - Math.min(...chartData.map(d => parseFloat(d.price)))) / Math.min(...chartData.map(d => parseFloat(d.price))) * 100).toFixed(2) + '%'
                              : 'Calculating...'}
                          </p>
                          <p className="text-purple-300 text-xs mt-1">Price range over last 30 days</p>
                        </div>
                      </div>
                    </div>
                  </div>
                )}
              </div>
            </div>
          );
        }

        ReactDOM.render(<CryptoMonitor />, document.getElementById('root'));
    </script>
</body>
</html>
